
<a name="_top"></a>

1. **개요**
- CAR\_DEALER 데이터베이스 구현 및 Web 응용 작성
2. **상세 설계 내용**

각 코드들은 파일에 첨부할 것이며 반복적인 부분을 제외하고 핵심 부분만 이하 기술하겠습니다.

<ERD사상>

![image](https://github.com/heckzi/DB-Car-Dealer-Project/assets/110593187/1ba70b5d-19fd-4cc2-9187-024788e85993)

위와같이 ERD를 사상하였습니다.

User테이블은 각 Salesman(판매자)와 고객을 구분지어주는 역할을 합니다. 모든 판매자와 고객은 User테이블에 있어야 하므로 전체참여로 1대1 관계로 그려주었습니다.

Vehicle 테이블은 판매자가 판매도 할 수 있고 구매자는 구매를 하고 예약도 할 수 있기에 위와 같이 고객과 예약, 구매가 이어지도록 그렸습니다. 

차량은 한대당 판매가 되든 예약이 되고 고객과 판매자는 여러 개의 차량을 살 수 있기에 일대다 관계가 됩니다







<데이터베이스 테이블 스키마>
![image](https://github.com/heckzi/DB-Car-Dealer-Project/assets/110593187/51092508-8624-47d1-8b40-048fe285e4d0)


위의 ERD를 바탕으로 사상한 DB스키마 입니다. 이미 제3 정규형을 만족하는 스키마입니다.

각 테이블별로 PK를 노란색으로 표시해주었습니다. 또한 파란색은 Unique 속성을 뜻합니다.

그리고 FK – PK 관계를 화살표로 표시했습니다. 

처음에 s\_vin은 Vehicle.vin을 참조하게 했었지만 이후 판매한 차량을 DB에서 지워야하는 상황이 올 때 회사의 입장에서 판매기록은 따로 남겨져있어야 한다고 생각을 하여 참조를 지웠습니다.

C\_ssn, s\_ssn, salenum, reservenum은 auto increment 로 설정해 주었습니다.

Vehicle.Category는 차량의 종류가 세단인지, 트럭인지, SUV인지 구별하는 속성입니다.

이제 위의 스키마를 바탕으로 MySql에서 DB를 직접 설계하겠습니다.	 데이터 베이스 생성하는 Sql문은 CarProject.sql이라는 파일로 첨부하겠습니다.

car라는 Database를 사용하겠습니다.

현재 6개의 테이블이 존재합니다. 테이블 설명을 하겠습니다.

차량정보를 담는 vehicle 테이블입니다.

vin은 차량의 차대번호입니다.

![image](https://github.com/heckzi/DB-Car-Dealer-Project/assets/110593187/056e71c9-ff4f-4c72-b229-a30505edb5ad)

**그림 1 출처: [https://m.blog.naver.com/hwgi01/221183650544**](https://m.blog.naver.com/hwgi01/221183650544)**

vin은 17자리 varchar형입니다. 위 그림의 차대번호의 형식을 따라 설계했습니다. 하지만 이후 10만개의 차대번호 데이터를 생성할때엔 각 알파벳과 숫자가 뭘 의미하는지와 같은 세부적인 정보는 담아서 생성하지 못하고 숫자와 알파벳이 들어가야 할 위치만 맞춰 생성해주었습니다.

모든 어트리뷰트들은 not null이 되어야 합니다. category는 차량이 세단,트럭,suv인지 구별합니다.

고객 테이블입니다. c\_ssn은 고객을 관리하기 쉽게 번호를 매기는 어트리뷰트입니다. auto\_increment 속성을 가집니다.

이하 세개의 어트리뷰트는 varchar 형식을 가집니다. c\_phonenum은 휴대폰이 없는 사람도 있을 수 있으니 null 허용을 해주었습니다.

예약정보를 담는 reservation 테이블입니다. reservenum은 예약정보를 관리할 번호이며 auto\_increment 속성을 가집니다. rc\_ssn은 예약한 고객의 번호이고, r\_vin은 예약한 차량이며 r\_date는 차량예약을 한 날짜입니다.


판매정보를 담는 테이블입니다. salenum은 각 판매기록에 매겨지는 번호이며 auto\_increment입니다 s\_vin은 판매된 차량의 정보를 담습니다. 처음엔 FK로써 Vehicle.vin을 참조하였지만, 이후 참조 관계를 삭제했습니다. ss\_ssn은 판매자의 번호이고, sc\_ssn은 차량을 구매한 고객의 번호입니다. s\_date는 구매일자입니다.

판매자 정보를 가지는 테이블입니다. s\_ssn은 판매자의 번호이며 auto\_increment 입니다.

고객 테이블의 설명과 마찬가지로 s\_phonenum은 null허용입니다.

user 테이블입니다. 페이지에 로그인하기위해 필요한 id와 password를 가지며 role로 관리자(=판매자)인지 고객인지 구분시켜 주었습니다. uc\_ssn과 us\_ssn으로 로그인한 정보를 다른 테이블의 각 사람들과 설계과정에서 매칭시켜줍니다. 

![image](https://github.com/heckzi/DB-Car-Dealer-Project/assets/110593187/4fbfdcb0-2d49-4b72-8869-ebf79c2bfae5)

위는 설계한 Car 데이터베이스의 Workbench상 ERD입니다. 노란색으로 보이는 available은 view이고 vehicle 테이블에 countVin이라는 인덱스를 확인 할 수 있습니다.

3. **결론**
- 이번 프로젝트를 하면서 새로운 미니월드를 사상하고 실제세계와 최대한 비슷하게 만드려고 노력을 하였지만 생각해야할 것이 너무 많아 생각 보다 시간소요가 많이 들었습니다.

구현하면서도 시간소요가 컸는데, 특히 js와 hbs에서 render를 해주어 변수내용을 전달받는 것과, 웹에서 입력받은 값들을 js 파일에서 사용할 수 있도록하는 것이 너무 어려웠습니다. 하지만 검색을 통해 query를 이용하는 방법, post요청을 통해 value값으로 넘기는 방법등 여러 방법들에 대해 깨우치고 숙달되니 체화가 된 것 처럼 잘 할 수 있었습니다. 또한 구현을 하면서 조금만 더 조금만 더 하는 인간의 욕심 때문에 새로운 것을 찾아보느라 시간을 많이 쓴 것 같습니다.

그래도 새로운 미니월드를 통해 DB설계를 처음부터 끝까지 진행하고 얕지만 프론트까지 직접 구현하니 능력치가 매우 향상되었던거 같습니다. 이번 수업을 들으며 새로운 것들을 많이 접하고 군복학 후라 모르는게 너무 많아서 막막했지만 프로젝트를 통해서 얻어가는 지식들이 많아 지금까지 학교에서 들은 수업 중 제일 유익한 수업이었던 것 같습니다.
